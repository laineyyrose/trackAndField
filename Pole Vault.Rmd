---
title: "Pole Vault"
author: "Lainey Rose"
date: "2023-01-13"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

First we need to import the data from the website, 'alltimeathletics.com'

```{r}
library(tidyverse)
library(readr)
library(dplyr)
womensPoleVault <- read.table("womenspolevault.txt", sep = '%', quote = "\"")
mensPoleVault <- read.table("menspolevault.txt", sep = '%', quote = "\"")
```
Next, I will need to create a table for the data to be stored in and later visualized. However, I tried to do this simply using read.delim, and there were many errors. There were some issues with how the data was separated, as well as a lack of column labels. To fix this, I created a vector for the column labels and separated each value by at least two spaces, like so:

```{r}
newWomens <- tidyr::separate(womensPoleVault, V1, c('EMPTY', 'RANK', 'HEIGHT', 
  'NAME', 'COUNTRY', 'BIRTHDATE', 'NUM', 'LOCATION', 'DATE'), sep = "\\s{2,}", ) %>%
  select(-EMPTY)
head(newWomens)

newMens <- tidyr::separate(mensPoleVault, V1, c('EMPTY', 'RANK', 'HEIGHT', 
  'NAME', 'COUNTRY', 'BIRTHDATE', 'NUM', 'LOCATION', 'DATE'), sep = "\\s{2,}", ) %>%
  select(-EMPTY)
head(newMens)
```

Now that I have loaded the data for both the men's and women's events, I will start by simplifying the data so that it only has what I will need for my analysis.

```{r}
womensSimplified <- newWomens %>% select(DATE, BIRTHDATE, HEIGHT, NAME, COUNTRY) %>% drop_na(DATE, BIRTHDATE, HEIGHT, NAME, COUNTRY)

mensSimplified <- newMens %>% select(DATE, BIRTHDATE, HEIGHT, NAME, COUNTRY) %>% drop_na(DATE, BIRTHDATE, HEIGHT, NAME, COUNTRY) 
```

I can now create a new table that has two additonal columns that only state the year, so that I can create an algorithm that strips the periods from both dates. 

```{r}
womenRevised <- womensSimplified %>% mutate(YEAR = substr(DATE, 7, 10)) %>% 
  mutate(BIRTHYEAR = substr(BIRTHDATE, 7, 10))
womenRevised$YEAR <- as.numeric(as.character(womenRevised$YEAR))
womenRevised$BIRTHYEAR <- as.numeric(as.character(womenRevised$BIRTHYEAR))
sapply(womenRevised, class)

menRevised <- mensSimplified %>% mutate(YEAR = substr(DATE, 7, 10)) %>% 
  mutate(BIRTHYEAR = substr(BIRTHDATE, 7, 10))
menRevised$YEAR <- as.numeric(as.character(menRevised$YEAR))
menRevised$BIRTHYEAR <- as.numeric(as.character(menRevised$BIRTHYEAR))
sapply(menRevised, class)

```
I now have to find the age of each individual by subtracting the date the event occurred by their birthdate minus 1900.

```{r}
library(lubridate)
Bday <- parse_date_time2(womenRevised$BIRTHDATE, 'dmy', cutoff_2000 = 15)
Rday <- parse_date_time2(womenRevised$DATE, 'dmY', cutoff_2000 = 20)
Dif <- difftime(Rday, Bday, units = 'weeks')
Please <- as.integer(Dif/52)
New <- womenRevised %>% mutate(AGE = as.integer(Please))
View(New)

menPlot <- menRevised %>% mutate(AGE = YEAR - BIRTHYEAR - 1900)
```

I now will need to remove trailing letters on the height so that I can correctly plot it.

```{r}
womenPlot$HEIGHT <- gsub('A','', womenPlot$HEIGHT)

menPlot$HEIGHT <- gsub('A', '', menPlot$HEIGHT)
```


Now that the data has been simplified and cleaned, it is time for visualizing the data, using a scatterplot.

```{r}
library(ggplot2)
ggplot(New, aes(x = AGE, y = HEIGHT, color = COUNTRY)) + geom_point()

ggplot(menPlot, aes(x = AGE, y = HEIGHT, color = COUNTRY)) + geom_point()

```

Now that the data has been visualized and we can get a better idea of what the data looks like its time to do some real statistics to see if there is a significant difference between womens and mens pole vault heights.
